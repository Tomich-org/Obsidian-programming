Файлы с переменными в Ansible используются для удобного хранения и управления данными, которые можно подключать к плейбукам, ролям или инвентарю. Обычно такие файлы пишутся в формате YAML.

### **Создание файла с переменными**
Файл с переменными содержит ключи и их значения. Вот пример простого файла:
Пример `vars/main.yml`:
```yaml
app_name: my_app
app_port: 8080
debug_mode: true
allowed_hosts:
  - localhost
  - 192.168.1.1
```
**Объяснение:**
- `app_name`, `app_port`, `debug_mode`: обычные переменные.
- `allowed_hosts`: список значений.
### **Где хранить файл с переменными**
1. **В папке `vars/` роли**: Если файл с переменными нужен для конкретной роли, он обычно помещается в папку `vars/main.yml` внутри структуры роли.
2. **В папке `group_vars/` или `host_vars/`**: Переменные для групп или отдельных узлов размещаются в соответствующих папках.    
3. **В любом месте проекта**: Для переменных, которые относятся к плейбуку, файл может быть создан в отдельной папке, например, `vars/`.
### **Подключение файла с переменными**
1. **В плейбуке**: Используй ключ `vars_files` для подключения файла.
```yaml
- hosts: all
  vars_files:
    - vars/settings.yml
  tasks:
    - name: Показать переменные
      debug:
        msg: "Приложение {{ app_name }} работает на порту {{ app_port }}"
```
2. **В роли**: Файл `vars/main.yml` подключается автоматически, если он находится внутри структуры роли.
```python
my_role/
├── vars/
│   └── main.yml
```
### **Сложные структуры в файлах с переменными**
Ansible поддерживает вложенные структуры (словарь, список внутри словаря и т.д.).
```yaml
web_server:
  name: nginx
  port: 80

db_server:
  type: postgresql
  port: 5432

allowed_ips:
  - 127.0.0.1
  - 192.168.1.1
```

Обращение к таким переменным:
```yaml
- name: Настроить веб-сервер
  debug:
    msg: "Сервер {{ web_server.name }} будет работать на порту {{ web_server.port }}"
```
### **Шифрование переменных с Ansible Vault**
Если файл содержит чувствительные данные (пароли, ключи), его можно зашифровать с помощью Ansible Vault.
 1. **Шифрование файла**:
```bash
ansible-vault encrypt vars/secrets.yml
```
 2. **Расшифровка файла**:
```bash
ansible-vault decrypt vars/secrets.yml
```
 3. **Подключение зашифрованного файла**: При запуске плейбука укажи флаг `--ask-vault-pass`:
```bash
ansible-playbook playbook.yml --ask-vault-pass
```

### **Подсказки**
1. **Проверяй синтаксис**: Если файл написан неправильно, Ansible выдаст ошибку. Для проверки:
```bash
ansible-playbook playbook.yml --syntax-check
```
2. **Используй модуль `debug`**: Для проверки, что переменные подгрузились корректно:
```yaml
- name: Показать переменные
  debug:
    var: app_name

```
