Когда на сервере заканчивается место на диске, важно действовать оперативно, чтобы избежать сбоев в работе. Вот пошаговое руководство:
### **1. Проверка использования диска**
Для начала нужно определить, какие каталоги или файлы занимают больше всего места.
- Общий обзор использования диска:
```bash
df -h
```
Показывает доступное место на всех разделах (в удобочитаемом формате).
Например:
```bash
/dev/sda1        50G   45G   5G  90% /
```
- Проверка конкретного каталога:
```bash
du -sh /path/to/directory
```
Показывает общий размер указанного каталога
- Поиск самых больших каталогов:
```bash
du -ah / | sort -rh | head -n 10
```
Покажет 10 самых больших файлов/каталогов.
 ### **2. Очистка временных файлов**
На сервере временные файлы часто занимают значительное место.
 - Очистить временные файлы:
```bash
sudo rm -rf /tmp/*
sudo rm -rf /var/tmp/*
```
- Очистка кешей пакетов:
**Debian/Ubuntu**
```bash
sudo apt-get clean
```
**RHEL/CentOS**:
```bash
sudo yum clean all
```

### **3. Удаление старых логов**
Логи могут накапливаться и занимать много места.
- Проверка размеров логов:
```bash
  sudo du -sh /var/log/*
```
- Удаление старых логов:
```bash
sudo find /var/log -type f -name "*.log" -mtime +30 -exec rm -f {} \;
```
Удаляет старше 30 дней
- Если лог-файлы очень большие, можно их обнулить:
```bash
sudo truncate -s 0 /var/log/large-log-file.log
```

### **4. Поиск и удаление мусора**
Поиск старых или ненужных файлов:
```bash
sudo find / -type f -size +500M
```
Находит файлы больше 500 МБ.

Удаление устаревших резервных копий или временных архивов:
- Проверьте папки вроде `/home/user/`, `/backup/`, `/var/www/`.

### **5. Удаление старых ядер (для Linux)**
На серверах может быть несколько старых версий ядра, которые занимают место.

Просмотр установленных ядер:
```bash
dpkg --list | grep linux-image
```

Удаление старых ядер (оставляя текущее и предыдущее):
```bash
sudo apt-get autoremove --purge
```

### **6. Очистка контейнеров (если используется Docker)**
Контейнеры и образы Docker часто занимают много места.

**Очистка неиспользуемых данных:**
```bash
docker system prune
```
Можно добавить флаг `-a` для удаления всех неиспользуемых образов

**Проверка использования Docker:**
```bash
docker system df
```

### **7. Расширение дискового пространства**
Если очистка не помогла, может потребоваться увеличить доступное пространство.

#### Увеличение раздела:
- Убедитесь, что на диске есть неиспользуемое пространство:
``` bash
lsblk
```
- Используйте утилиты для переразметки:
	- **`fdisk`** или **`parted`** для работы с разделами.
	- **`resize2fs`** для изменения размеров файловой системы.
#### Добавление нового диска:
- Подключите новый диск.
- Создайте файловую систему:
```bash
mkfs.ext4 /dev/sdX
```
- Смонтируйте его в нужный каталог:
```bash
mount /dev/sdX /mnt/new-disk
```

### **8. Мониторинг использования диска**
Чтобы в будущем избежать подобных ситуаций:
- Настройте мониторинг дискового пространства:
  Используйте **`ncdu`** для интерактивного анализа
```bash
sudo ncdu /
```
Используйте скрипты или инструменты, такие как **Nagios**, **Zabbix**, или **Prometheus**, для автоматического отслеживания места.
